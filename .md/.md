# CLI quick reference



## Run endpoints (build Excel + JSON)
From project root:
- STAGE (discoveryTest)
```bash
npm run retrieval:staging_text -- --verbose true --debug true
```
- PROD (discover)
```bash
npm run retrieval:prod -- --verbose true --debug true
```

Outputs:
- Excel: `retrieval-automation/results/<endpoint>_<timestamp>.xlsx`
- JSON: `retrieval-automation/results/json/<endpoint>_<timestamp>.json`

## Compare (single workbook)
```bash
npm run retrieval:compare
```
Sheets in output:
- `PROD` (discover)
- `STAGE` (discoveryTest)
- `compare` (matched by _id; shows ranks/scores)

Rename tabs manually to your snapshot labels (e.g., `010825-PROD`, `080825-STAGE`).

## Quick run (1–N ad‑hoc questions)
STAGE example:
```bash
npm run retrieval:quick -- --endpoint discoveryTest --questions "When is next APICon New York happening?" "When is next apicon New York happening?"
```
Output: `retrieval-automation-quick/results/two_questions_discoveryTest_<timestamp>.xlsx`

PROD example:
```bash
npm run retrieval:quick -- --endpoint discover --questions "When is next APICon New York happening?"
```

## STAGE old vs STAGE new (no code change)
1) Identify two STAGE JSONs: old `discoveryTest_OLD.json`, new `discoveryTest_NEW.json` in `retrieval-automation/results/json/`.
2) Alias old STAGE as `discover_*` so compare treats it as left:
```bash
cp retrieval-automation/results/json/discoveryTest_OLD.json \
   retrieval-automation/results/json/discover_stage_old.json
```
3) Run compare:
```bash
npm run retrieval:compare
```
4) In the output workbook, rename tabs:
- `PROD` → `STAGE (old)`
- `STAGE` → `STAGE (new)`

## Field meanings
- Rank: position in endpoint results for that question (0 = top).
- Score: retrieval score returned by endpoint.